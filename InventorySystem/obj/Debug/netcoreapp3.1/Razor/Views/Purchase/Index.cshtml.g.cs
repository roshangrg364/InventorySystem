#pragma checksum "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "82c0e29801b61e3fa9f6078750cc2257834c5c69"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Purchase_Index), @"mvc.1.0.view", @"/Views/Purchase/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\_ViewImports.cshtml"
using InventorySystem;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\_ViewImports.cshtml"
using InventorySystem.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"82c0e29801b61e3fa9f6078750cc2257834c5c69", @"/Views/Purchase/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"08ca94934fdec9c383665cb0a4ad5df7ff12d6ca", @"/Views/_ViewImports.cshtml")]
    public class Views_Purchase_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<PurchaseSummary>
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("method", "post", global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper;
        private global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 2 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
  
    ViewData["Title"] = "Purchase";
    Layout = "~/Views/Shared/_Layout.cshtml";

#line default
#line hidden
#nullable disable
            WriteLiteral("<div class=\"container\">\r\n    <h2 class=\"text-center\">Purchase Form</h2>\r\n    <div class=\"row\">\r\n\r\n        <div class=\"col-md-4\">\r\n            ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("form", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "82c0e29801b61e3fa9f6078750cc2257834c5c693958", async() => {
                WriteLiteral("\r\n               \r\n                <div class=\"form-group\">\r\n                    ");
#nullable restore
#line 14 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
               Write(Html.DisplayNameFor(a => a.sup_id));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                    ");
#nullable restore
#line 15 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
               Write(Html.DropDownListFor(a => a.sup_id, new SelectList(ViewBag.suppliers, "sup_id", "FullName"), new { @class = "form-control supplier" }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                    ");
#nullable restore
#line 16 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
               Write(Html.ValidationMessageFor(a => a.sup_id, "", new { @class = "text-danger" }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label>Category</label>\r\n                    ");
#nullable restore
#line 20 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
               Write(Html.DropDownList("category", new SelectList(ViewBag.categories, "cat_id", "category"), new { @class = "form-control category-drop " }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                </div>\r\n                <div class=\"form-group\">\r\n                    <label>product</label>\r\n                    ");
#nullable restore
#line 24 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
               Write(Html.DropDownList("product", new SelectList(ViewBag.product, "p_id", "product"), new { @class = "form-control product-drop" }));

#line default
#line hidden
#nullable disable
                WriteLiteral(@"
                    <div class=""msg text-danger text-center""></div>
                </div>
                <!--hidden input to check the available quantity-->
                <input type=""text"" name=""qty"" class=""qtycheck form-control"" style=""display:none;""  />

                <div class=""form-group"">
                    <label>Qty</label>
                    <input type=""text"" name=""qty"" class=""qty form-control"" />
                    <div class=""msg text-danger text-center""></div>
                </div>
                <div class=""form-group"">
                    <label>Price</label>
                    <input type=""text"" name=""price"" class=""price form-control"" />
                    <div class=""msg text-danger text-center""></div>
                </div>
                <div class=""form-group"">
                    <button class=""btn btn-primary btn-sm btn-addtolist"">AddToList</button>
                    <div class=""msg text-success text-center""></div>
                </div>
            ");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper);
            __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper);
            __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper.Method = (string)__tagHelperAttribute_0.Value;
            __tagHelperExecutionContext.AddTagHelperAttribute(__tagHelperAttribute_0);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"
        </div>

        <div class=""col-md-8"">
            <h2 class=""text-center"">purchase Details</h2>
            <table class=""table"" style="" height:40vh;display:inline-block; overflow:scroll;width:100%;"">
                <thead>
                    <tr>
                        <th>Product Id</th>
                        <th>Product</th>
                        <th>Qty</th>
                        <th>Price</th>
                        <th>Total</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>

            </table>

            <div>
                ");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("form", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "82c0e29801b61e3fa9f6078750cc2257834c5c699182", async() => {
                WriteLiteral("\r\n                    <div class=\"form-group\">\r\n                        ");
#nullable restore
#line 68 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.DisplayNameFor(a => a.total));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 69 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.TextBoxFor(a => a.total, new { @class = "form-control-sm total-amount" }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 70 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.ValidationMessageFor(a => a.total));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        ");
#nullable restore
#line 73 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.DisplayNameFor(a => a.discount));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 74 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.TextBoxFor(a => a.discount, new { @class = "form-control-sm discount", placeholder = "0" }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 75 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.ValidationMessageFor(a => a.discount));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        ");
#nullable restore
#line 78 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.DisplayNameFor(a => a.vat));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 79 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.TextBoxFor(a => a.vat, new { @class = "form-control-sm vat ", placeholder = "0" }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 80 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.ValidationMessageFor(a => a.vat));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                    </div>\r\n\r\n                    <div class=\"form-group\">\r\n                        ");
#nullable restore
#line 84 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.DisplayNameFor(a => a.net_total));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 85 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.TextBoxFor(a => a.net_total, new { @class = "form-control-sm net-total", placeholder = "0" }));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                        ");
#nullable restore
#line 86 "C:\Users\Roshan\Desktop\InventorySystem\InventorySystem\Views\Purchase\Index.cshtml"
                   Write(Html.ValidationMessageFor(a => a.net_total));

#line default
#line hidden
#nullable disable
                WriteLiteral("\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <button type=\"submit\" class=\"btn btn-primary btn-save  btn-sm\">Save</button>\r\n                        <a");
                BeginWriteAttribute("href", " href=\"", 4362, "\"", 4369, 0);
                EndWriteAttribute();
                WriteLiteral(" class=\"btn btn-primary btn-bill btn-sm \">Bill</a>\r\n\r\n                    </div>\r\n                ");
            }
            );
            __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.FormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper);
            __Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.TagHelpers.RenderAtEndOfFormTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_TagHelpers_RenderAtEndOfFormTagHelper);
            __Microsoft_AspNetCore_Mvc_TagHelpers_FormTagHelper.Method = (string)__tagHelperAttribute_0.Value;
            __tagHelperExecutionContext.AddTagHelperAttribute(__tagHelperAttribute_0);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n");
            DefineSection("scripts", async() => {
                WriteLiteral(@"
    <script>

        $(document).ready(function () {
            $('.category-drop').change(function () {
                event.preventDefault();
                var cat_id = $('.category-drop ').val();
                var url = `/Purchase/GetProductList?id=${cat_id}`;
                $.ajax({
                    url: url,
                    type: 'get',
                    dataType: 'json',
                    success: function (data, status) {
                        $('.product-drop > option').remove();

                        for (var i = 0; i < data.length; i++) {
                            $("".product-drop"").append(""<option value = '"" + data[i].p_id + "" '>"" + data[i].pr + "" </option>"");

                        }
                        $('.product-drop').trigger(""change"");

                    }
                })

            })



            $('.product-drop').on('change', function (e) {
                e.preventDefault();
                var p_id = $('.product-dro");
                WriteLiteral(@"p').val();
                var url = `/Purchase/GetPrice?id=${p_id}`;
                $.ajax({
                    url: url,
                    type: 'get',
                    dataType: 'json',
                    success: function (data, status) {

                        $('.price').val(data.price);
                        $('.qtycheck').val(data.qty);

                    }
                })
            })


            $('.btn-addtolist').on('click', function (e) {
                e.preventDefault();
                var qtycheck = $('.qtycheck').val();
                var p_id = $('.product-drop').val();
                var product = $('.product-drop option:selected').text();
                var qty = $('.qty').val();
                var price = $('.price').val();
                var total = (qty * price);
                if (parseFloat(qty) > parseFloat(qtycheck)) {
                    alert(""enter the quantity or your quantity is more than the stock"");
                    re");
                WriteLiteral(@"turn;
                }
                $('.table tbody').append(
                    `
                                            <tr>
                                                <td class=""p_id"">${p_id}</td>
                                                <td class=""productname"">${product}</td>
                                                <td class=""quantity"">${qty}</td>
                                                <td class=""priceamt"">${price}</td>
                                                <td class =""total"">${total}</td>
                                                <td> <a class=""btn btn-info btn-remove btn-sm"">Remove</a> </td>
                                            </tr>       `
                )
                calculate();

            })


            $('body').delegate('.btn-remove', 'click', function (e) {
                e.preventDefault();
                $(this).closest('tr').remove();
                calculate();

            })

            $('.");
                WriteLiteral(@"btn-save').on('click', function (e) {
                e.preventDefault();
                
                var url = `/Purchase/Add`;
                var data = {
                    sup_id: $('.supplier').val(),
                    total_amount: $('.total-amount').val(),
                    discount: $('.discount').val(),
                    vat: $('.vat').val(),
                    netamount: $('.net-total').val(),
                    purchase_details: [],
                };
                
                $('.table>tbody>tr').each(function () {
                    data.purchase_details.push({
                        product_id: $(this).find('.p_id').text(),
                        qty: $(this).find('.quantity').text(),
                        price: $(this).find('.priceamt').text(),
                        total: $(this).find('.total').text(),
                    })

                });
                $.ajax({
                    url: url,
                    type: 'post',
      ");
                WriteLiteral(@"              dataType: 'json',
                    data: data,
                    success: function (data,status) {
                        console.log(data.id);
                      $('.btn-bill').attr(""href"", `/purchase/Bill?id=${data.id}`);
                        alert(""Saved successfully"");
                    }
                })


            })


            function calculate() {
                var total_amount = 0;
                $('.table>tbody>tr').each(function () {
                    var total = $(this).find('td').eq(4).text();

                    total_amount = total_amount + parseFloat(total);

                })

                $('.total-amount').val(total_amount);
            }


            $('.discount').on('change', function () {

                nettotal();
            })


            $('.vat').on('change', function () {

                nettotal();
            })

            function nettotal() {
                var net_total =0;
        ");
                WriteLiteral(@"        var total = $('.total-amount').val();
                var discount = $('.discount').val();
                var vat = $('.vat').val();
                net_total = total - discount - vat;
                $('.net-total').val(net_total);
            }
            //lu aaba run gar 
            //$('body').delegate('.btn-bill','click', function () {
            //    event.preventDefault();
                
            //    url = $('.btn-bill').attr('href');
            //    console.log(url);
            //        alert('success');
            //    $.ajax({
            //        url: url,
            //        type: 'get',
            //        success: function () {

            //        }

            //    })
            //})
        })



    </script>
");
            }
            );
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<PurchaseSummary> Html { get; private set; }
    }
}
#pragma warning restore 1591
